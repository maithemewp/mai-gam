window.googletag=window.googletag||{},googletag.cmd=googletag.cmd||[];const ads=maiPubAdsVars.ads,adSlotIds=[],adSlots=[],gamBase=maiPubAdsVars.gamBase,gamBaseClient=maiPubAdsVars.gamBaseClient,refreshKey="refresh",refreshValue=maiPubAdsVars.targets.refresh,refreshTime=30,loadTimes={},currentlyVisible={},timeoutIds={},debug=window.location.search.includes("dfpdeb")||window.location.search.includes("maideb"),log=maiPubAdsVars.debug;let timestamp=Date.now();function maiPubDOMContentLoaded(){const e=[],a=document.querySelectorAll('.mai-ad-unit[data-ap="atf"], .mai-ad-unit[data-ap="bs"]'),t=document.querySelectorAll('.mai-ad-unit:not([data-ap="atf"]):not([data-ap="bs"])');googletag.cmd.push((()=>{a.forEach((a=>{const t=a.getAttribute("id").replace("mai-ad-","");e.push(maiPubDefineSlot(t)),debug&&(a.style.outline="2px dashed limegreen",a.setAttribute("data-label",t))})),e.length&&maiPubDisplaySlots(e)}));const s=new IntersectionObserver(((e,a)=>{let t=[];e.forEach((e=>{if(!e.isIntersecting)return;const s=e.target.getAttribute("id").replace("mai-ad-","");debug&&(e.target.style.outline="2px dashed red",e.target.setAttribute("data-label",s)),t.push(s),a.unobserve(e.target)})),t.length&&(googletag.cmd.push((()=>{maiPubDisplaySlots(t.map((e=>maiPubDefineSlot(e))))})),t=[])}),{root:null,rootMargin:"600px 0px 600px 0px",threshold:0});t.forEach((e=>{s.observe(e)}))}function maiPubDefineSlot(e){let a=null;const t=(ads?.[e]?.context&&"client"===ads[e].context?gamBaseClient:gamBase)+ads[e].id,s=googletag.defineSlot(t,ads[e].sizes,"mai-ad-"+e);return googletag.display("mai-ad-"+e),maiPubLog("defineSlot() & display(): "+e),adSlotIds.push(t),adSlots.push(s),s.setTargeting("refresh",refreshValue),ads[e].targets&&Object.keys(ads[e].targets).forEach((a=>{s.setTargeting(a,ads[e].targets[a])})),ads[e].splitTest&&"rand"===ads[e].splitTest&&s.setTargeting("st",Math.floor(100*Math.random())),s.addService(googletag.pubads()),s.defineSizeMapping(googletag.sizeMapping().addSize([1024,768],ads[e].sizesDesktop).addSize([728,480],ads[e].sizesTablet).addSize([0,0],ads[e].sizesMobile).build()),a=s,a}function maiPubDisplaySlots(e){googletag.enableServices();const a={adserverRequestSent:!1,dmBidsReceived:!0,apsBidsReceived:!1},t=function(){a.adserverRequestSent||(a.adserverRequestSent=!0,googletag.pubads().refresh(e))};if(maiPubAdsVars.amazonUAM){const s=[];e.forEach((e=>{const a=e.getSlotElementId().replace("mai-ad-","");1===ads[a].sizes.length&&"fluid"===ads[a].sizes[0]||ads?.[a]?.context&&"client"===ads[a].context||s.push({slotID:"mai-ad-"+a,slotName:gamBase+ads[a].id,sizes:ads[a].sizes})})),s.length?apstag.fetchBids({slots:s,timeout:2e3,params:{adRefresh:"1"}},(function(e){apstag.setDisplayBids(),a.apsBidsReceived=!0,a.dmBidsReceived&&(t(),maiPubLog("refresh() with amazon fetch: "+s.map((e=>e.slotID.replace("mai-ad-",""))).join(", "))),(debug||log)&&e.forEach((e=>{e.error&&maiPubLog("apstag.fetchBids error:",e)}))})):e.length&&(a.apsBidsReceived=!0,a.dmBidsReceived&&(t(),maiPubLog("refresh() without amazon slots to fetch: "+e.map((e=>e.getSlotElementId())).join(", "))))}else{if(!e.length)return;a.apsBidsReceived=!0,a.dmBidsReceived&&t(),maiPubLog("refresh() with GAM:"+e.map((e=>e.getSlotElementId())).join(", "))}setTimeout((()=>{a.adserverRequestSent||maiPubLog("refresh() with failsafe timeout: "+e.map((e=>e.getSlotElementId())).join(", ")),t()}),3500)}function maiPubIsMaiSlot(e){return e&&adSlotIds.includes(e.getAdUnitPath())}function maiPubIsRefreshable(e){return maiPubIsMaiSlot(e)&&Boolean(e.getTargeting("refresh").shift())}function maiPubRefreshSlots(e){maiPubAdsVars.amazonUAM&&(maiPubLog("setDisplayBids via apstag: "+e.map((e=>e.getSlotElementId())).join(", ")),apstag.setDisplayBids()),googletag.pubads().refresh(e,{changeCorrelator:!1})}function maiPubLog(...e){if(!debug&&!log)return;let a="maipub ";const t=Date.now();(new Date).toLocaleTimeString("en-US",{hour12:!0});a+=timestamp===t?"start":t-timestamp+"ms"}maiPubLog("v198"),maiPubAdsVars.amazonUAM&&(!function(e,a,t,s,i,o,d){function n(t,s){a[e]._Q.push([t,s])}a[e]||(a[e]={init:function(){n("i",arguments)},fetchBids:function(){n("f",arguments)},setDisplayBids:function(){},targetingKeys:function(){return[]},_Q:[]},(o=t.createElement(s)).async=!0,o.src="//c.amazon-adsystem.com/aax2/apstag.js",(d=t.getElementsByTagName(s)[0]).parentNode.insertBefore(o,d))}("apstag",window,document,"script"),apstag.init({pubID:"79166f25-5776-4c3e-9537-abad9a584b43",adServer:"googletag",schain:{complete:1,ver:"1.0",nodes:[{asi:"bizbudding.com",sid:maiPubAdsVars.sellersId,hp:1,name:maiPubAdsVars.sellersName,domain:maiPubAdsVars.domain}]}})),googletag.cmd.push((()=>{maiPubAdsVars.targets&&Object.keys(maiPubAdsVars.targets).forEach((e=>{googletag.pubads().setTargeting(e,maiPubAdsVars.targets[e].toString())})),googletag.pubads().setCentering(!0),googletag.pubads().disableInitialLoad(),googletag.pubads().enableSingleRequest(),maiPubAdsVars.loadDelay?window.addEventListener("load",(function(){setTimeout(maiPubDOMContentLoaded,maiPubAdsVars.loadDelay)})):"loading"===document.readyState?document.addEventListener("DOMContentLoaded",maiPubDOMContentLoaded):maiPubDOMContentLoaded(),googletag.pubads().addEventListener("impressionViewable",(function(e){const a=e.slot,t=a.getSlotElementId();maiPubIsRefreshable(a)&&(loadTimes[t]=Date.now(),timeoutIds[t]&&clearTimeout(timeoutIds[t]),timeoutIds[t]=setTimeout((()=>{maiPubLog("refreshed via impressionViewable: "+t),maiPubRefreshSlots([a])}),3e4))})),googletag.pubads().addEventListener("slotVisibilityChanged",(e=>{const a=e.slot,t=a.getSlotElementId(),s=e.inViewPercentage>5;if(maiPubIsRefreshable(a)){if(s&&!currentlyVisible[t])currentlyVisible[t]=!0;else{if(s||!currentlyVisible[t])return;currentlyVisible[t]=!1}currentlyVisible[t]?!loadTimes?.[t]||loadTimes[t]&&Date.now()-loadTimes[t]<3e4||(maiPubLog("refreshed via slotVisibilityChanged: "+t.replace("mai-ad-","")),maiPubRefreshSlots([a])):clearTimeout(timeoutIds[t])}})),googletag.pubads().addEventListener("slotRenderEnded",(e=>{if(!e.isEmpty)return;if(!maiPubIsMaiSlot(e.slot))return;const a=e.slot.getSlotElementId().replace("mai-ad-","");"client"===ads[a].context&&ads?.[a]?.backfill&&ads?.[a]?.backfillId})),(debug||log)&&(googletag.pubads().addEventListener("slotRequested",(e=>{maiPubLog("slotRequested: "+e.slot.getSlotElementId().replace("mai-ad-",""),e)})),googletag.pubads().addEventListener("slotResponseReceived",(e=>{maiPubLog("slotResponseReceived: "+e.slot.getSlotElementId().replace("mai-ad-",""),e)})),googletag.pubads().addEventListener("slotOnload",(e=>{maiPubLog("slotOnload: "+e.slot.getSlotElementId().replace("mai-ad-",""),e)})),googletag.pubads().addEventListener("slotRenderEnded",(e=>{maiPubLog("slotRenderEnded: "+e.slot.getSlotElementId().replace("mai-ad-",""),e)})))}));